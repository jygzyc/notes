<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=Ecool><link href=../../python/discussion-25/ rel=prev><link href=../../../program_analysis/static_program_analysis/discussion-23/ rel=next><link rel=icon href=../../../../assets/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.41"><title>半小时学习Rust - Ecool的知识花园</title><link rel=stylesheet href=../../../../assets/stylesheets/main.0253249f.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Microsoft+Yahei:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Microsoft Yahei";--md-code-font:"JetBrains Mono"}</style><link rel=stylesheet href=../../../../css/extra.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/default.min.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../../../.. title=Ecool的知识花园 class="md-header__button md-logo" aria-label=Ecool的知识花园 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Ecool的知识花园 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 半小时学习Rust </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue-grey data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=查找> <a href=javascript:void(0) class="md-search__icon md-icon" title=分享 aria-label=分享 data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=清空当前内容 aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jygzyc/Notes title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> Ecool的知识花园 </div> </a> </div> </nav> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../.. class=md-tabs__link> 主页 </a> </li> <li class=md-tabs__item> <a href=../../../../site-message/ class=md-tabs__link> 留言板 </a> </li> <li class=md-tabs__item> <a href=../../../../life/cuisine/discussion-6/ class=md-tabs__link> 生活 </a> </li> <li class=md-tabs__item> <a href=../../../../essay/article/discussion-5/ class=md-tabs__link> 随笔 </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../../android/kernel/discussion-18/ class=md-tabs__link> 技术 </a> </li> <li class=md-tabs__item> <a href=../../../../blog/ class=md-tabs__link> 博客 </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title=Ecool的知识花园 class="md-nav__button md-logo" aria-label=Ecool的知识花园 data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Ecool的知识花园 </label> <div class=md-nav__source> <a href=https://github.com/jygzyc/Notes title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> Ecool的知识花园 </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../.. class=md-nav__link> <span class=md-ellipsis> 主页 </span> </a> </li> <li class=md-nav__item> <a href=../../../../site-message/ class=md-nav__link> <span class=md-ellipsis> 留言板 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../life/cuisine/discussion-6/ class=md-nav__link> <span class=md-ellipsis> 生活 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../essay/article/discussion-5/ class=md-nav__link> <span class=md-ellipsis> 随笔 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5 checked> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex> <span class=md-ellipsis> 技术 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=true> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> 技术 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_1> <label class=md-nav__link for=__nav_5_1 id=__nav_5_1_label tabindex> <span class=md-ellipsis> Android </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_1_label aria-expanded=false> <label class=md-nav__title for=__nav_5_1> <span class="md-nav__icon md-icon"></span> Android </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../android/kernel/discussion-18/ class=md-nav__link> <span class=md-ellipsis> Kernel </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../android/reverse/discussion-12/ class=md-nav__link> <span class=md-ellipsis> 逆向分析 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../android/rom/discussion-4/ class=md-nav__link> <span class=md-ellipsis> ROM定制 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../android/security/discussion-22/ class=md-nav__link> <span class=md-ellipsis> 漏洞与安全 </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex> <span class=md-ellipsis> 折腾 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> 折腾 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../mess/discussion-11/ class=md-nav__link> <span class=md-ellipsis> 双系统配置合集 </span> </a> </li> <li class=md-nav__item> <a href=../../../mess/discussion-15/ class=md-nav__link> <span class=md-ellipsis> QQ NT插件使用 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_3 checked> <label class=md-nav__link for=__nav_5_3 id=__nav_5_3_label tabindex> <span class=md-ellipsis> 编程 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=true> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> 编程 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../js/discussion-7/ class=md-nav__link> <span class=md-ellipsis> JavaScript </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../python/discussion-25/ class=md-nav__link> <span class=md-ellipsis> Python </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_3_3 checked> <label class=md-nav__link for=__nav_5_3_3 id=__nav_5_3_3_label tabindex=0> <span class=md-ellipsis> Rust </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_5_3_3_label aria-expanded=true> <label class=md-nav__title for=__nav_5_3_3> <span class="md-nav__icon md-icon"></span> Rust </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 半小时学习Rust </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_4> <label class=md-nav__link for=__nav_5_4 id=__nav_5_4_label tabindex> <span class=md-ellipsis> 程序分析 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> 程序分析 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../program_analysis/static_program_analysis/discussion-23/ class=md-nav__link> <span class=md-ellipsis> 静态程序分析 </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_5> <label class=md-nav__link for=__nav_5_5 id=__nav_5_5_label tabindex> <span class=md-ellipsis> 工具 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5_5> <span class="md-nav__icon md-icon"></span> 工具 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../tools/discussion-31/ class=md-nav__link> <span class=md-ellipsis> 常用工具集合 </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/discussion-14/ class=md-nav__link> <span class=md-ellipsis> docker使用记录 </span> </a> </li> <li class=md-nav__item> <a href=../../../tools/discussion-26/ class=md-nav__link> <span class=md-ellipsis> Ghidra使用与指南 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../../blog/ class=md-nav__link> <span class=md-ellipsis> 博客 </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/jygzyc/Notes/edit/master/docs/technology/program/rust/a-half-hour-to-learn-rust.md title=编辑此页 class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/jygzyc/Notes/raw/master/docs/technology/program/rust/a-half-hour-to-learn-rust.md title=查看本页的源代码 class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1>半小时学习Rust</h1> <!-- a-half-hour-to-learn-rust --> <blockquote> <p>个人笔记：按照个人的学习路线，进行了记录</p> </blockquote> <p>为了提高编程语言的流畅性，人们必须阅读大量编程语言的相关知识。但如果你不知道它的含义，你怎么能读这么多呢？ 在本文中，我不会专注于一两个概念，而是尝试尽可能多地浏览 Rust 片段，并解释它们包含的关键字和符号的含义。 准备好了吗？冲！<sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup> <sup id=fnref:2><a class=footnote-ref href=#fn:2>2</a></sup> <sup id=fnref:3><a class=footnote-ref href=#fn:3>3</a></sup> <sup id=fnref:4><a class=footnote-ref href=#fn:4>4</a></sup> （根据情况更新笔记）</p> <p><code>let</code>引入了一个变量绑定：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=p>;</span><span class=w> </span><span class=c1>// 声明 &quot;x&quot;</span>
</span><span id=__span-0-2><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=p>;</span><span class=w> </span><span class=c1>// 将 42 分配给“x”</span>
</span></code></pre></div></td></tr></table></div> <p>也可以写成一行：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-1-1><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=p>;</span>
</span></code></pre></div></td></tr></table></div> <p>可以使用<code>:</code>显式地指定变量的类型</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-2-1><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=p>:</span><span class=w> </span><span class=kt>i32</span><span class=p>;</span><span class=w> </span><span class=c1>// `i32` 是一个有符号的 32 位整数</span>
</span><span id=__span-2-2><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=p>;</span>
</span><span id=__span-2-3><span class=c1>// 有 i8、i16、i32、i64、i128 表示其他位数的有符号整数</span>
</span><span id=__span-2-4><span class=c1>// 还有 u8、u16、u32、u64、u128 表示无符号整数</span>
</span><span id=__span-2-5><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=p>:</span><span class=w> </span><span class=kt>i32</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=p>;</span><span class=w> </span><span class=c1>// 这也可以写成一行</span>
</span></code></pre></div></td></tr></table></div> <p>如果您声明一个变量并稍后对其进行初始化，在初始化之前编译器将阻止您使用它，即禁止在初始化前调用</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-3-1><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=p>;</span>
</span><span id=__span-3-2><span class=n>foobar</span><span class=p>(</span><span class=n>x</span><span class=p>);</span><span class=w> </span><span class=c1>// error: borrow of possibly-uninitialized variable: `x`</span>
</span><span id=__span-3-3><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=p>;</span>
</span></code></pre></div></td></tr></table></div> <p>下面这样做是完全没问题的：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-4-1><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=p>;</span>
</span><span id=__span-4-2><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=p>;</span>
</span><span id=__span-4-3><span class=n>foobar</span><span class=p>(</span><span class=n>x</span><span class=p>);</span><span class=w> </span><span class=c1>// `x` 的类型可以推断出来</span>
</span></code></pre></div></td></tr></table></div> <p>下划线<code>_</code>是一个特殊名称——或者更确切地说，是“不需要名称”。<code>_</code>基本上意味着丢掉一些东西：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-5-1><span class=c1>// *什么也没做*，因为 42 是一个常数</span>
</span><span id=__span-5-2><span class=kd>let</span><span class=w> </span><span class=n>_</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=p>;</span>
</span><span id=__span-5-3>
</span><span id=__span-5-4><span class=c1>// 这调用了 `get_thing` 但不需要返回结果</span>
</span><span id=__span-5-5><span class=kd>let</span><span class=w> </span><span class=n>_</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>get_thing</span><span class=p>();</span>
</span></code></pre></div></td></tr></table></div> <p>以下划线“开头”的名称是常规名称，有一点特殊的是，编译器不会警告它们未被使用</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-6-1><span class=c1>// 我们最终可能会使用 `_x`，但我们的代码仍在编写中</span>
</span><span id=__span-6-2><span class=c1>// 我们现在只想摆脱编译器的警告。</span>
</span><span id=__span-6-3><span class=kd>let</span><span class=w> </span><span class=n>_x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=err>；</span>
</span></code></pre></div></td></tr></table></div> <p>可以引入具有相同名称的单独绑定，它会“隐藏”前一个变量绑定：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-7-1><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>13</span><span class=p>;</span>
</span><span id=__span-7-2><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>3</span><span class=p>;</span>
</span><span id=__span-7-3><span class=c1>// 该行之后使用“x”仅引用第二个“x”，</span>
</span><span id=__span-7-4><span class=c1>// 第一个“x”不再存在。</span>
</span></code></pre></div></td></tr></table></div> <p>Rust 有<code>tuple</code>——元组类型，您可以将其视为“固定长度的不同类型的集合”。</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-8-1><span class=kd>let</span><span class=w> </span><span class=n>pair</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=sc>&#39;a&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>17</span><span class=p>);</span>
</span><span id=__span-8-2><span class=n>pair</span><span class=p>.</span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=c1>// this is &#39;a&#39;</span>
</span><span id=__span-8-3><span class=n>pair</span><span class=p>.</span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=c1>// this is 17</span>
</span></code></pre></div></td></tr></table></div> <p>如果我们真的想给元组中变量增加类型注解，可以用<code>pair</code>：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-9-1><span class=kd>let</span><span class=w> </span><span class=n>pair</span><span class=p>:</span><span class=w> </span><span class=p>(</span><span class=kt>char</span><span class=p>,</span><span class=w> </span><span class=kt>i32</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=sc>&#39;a&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>17</span><span class=p>);</span>
</span></code></pre></div></td></tr></table></div> <p>元组可以通过赋值的方式被“解构”(destructured)，这意味着它们被分解为各自的字段：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-10-1><span class=kd>let</span><span class=w> </span><span class=p>(</span><span class=n>some_char</span><span class=p>,</span><span class=w> </span><span class=n>some_int</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=sc>&#39;a&#39;</span><span class=p>,</span><span class=w> </span><span class=mi>17</span><span class=p>);</span>
</span><span id=__span-10-2><span class=c1>// 现在，`some_char` 是 &#39;a&#39;，`some_int` 是 17</span>
</span></code></pre></div></td></tr></table></div> <p>当函数返回元组类型时特别管用：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-11-1><span class=kd>let</span><span class=w> </span><span class=p>(</span><span class=n>left</span><span class=p>,</span><span class=w> </span><span class=n>right</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>slice</span><span class=p>.</span><span class=n>split_at</span><span class=p>(</span><span class=n>middle</span><span class=p>);</span>
</span></code></pre></div></td></tr></table></div> <p>当然，在解构一个元组时，可以用 <code>_</code> 舍弃掉一部分字段：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-12-1><span class=kd>let</span><span class=w> </span><span class=p>(</span><span class=n>_</span><span class=p>,</span><span class=w> </span><span class=n>right</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>slice</span><span class=p>.</span><span class=n>split_at</span><span class=p>(</span><span class=n>middle</span><span class=p>);</span>
</span></code></pre></div></td></tr></table></div> <p>分号表示语句的结尾：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-13-1><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>3</span><span class=p>;</span>
</span><span id=__span-13-2><span class=kd>let</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>5</span><span class=p>;</span>
</span><span id=__span-13-3><span class=kd>let</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>x</span><span class=p>;</span>
</span></code></pre></div></td></tr></table></div> <p>这意味着语句可以写成多行：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-14-1><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=fm>vec!</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=mi>5</span><span class=p>,</span><span class=w> </span><span class=mi>6</span><span class=p>,</span><span class=w> </span><span class=mi>7</span><span class=p>,</span><span class=w> </span><span class=mi>8</span><span class=p>]</span>
</span><span id=__span-14-2><span class=w>    </span><span class=p>.</span><span class=n>iter</span><span class=p>()</span>
</span><span id=__span-14-3><span class=w>    </span><span class=p>.</span><span class=n>map</span><span class=p>(</span><span class=o>|</span><span class=n>x</span><span class=o>|</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>3</span><span class=p>)</span>
</span><span id=__span-14-4><span class=w>    </span><span class=p>.</span><span class=n>fold</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=o>|</span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=o>|</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>y</span><span class=p>);</span>
</span></code></pre></div></td></tr></table></div> <p>（我们稍后会讨论这些代码的实际含义）。</p> <p><code>fn</code>用来声明一个函数。</p> <p>下面是一个 void 函数：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-15-1><span class=k>fn</span><span class=w> </span><span class=nf>greet</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-15-2><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Hi there!&quot;</span><span class=p>);</span>
</span><span id=__span-15-3><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>下面是一个返回 32 位有符号整数的函数。使用箭头指示其返回类型：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-16-1><span class=k>fn</span><span class=w> </span><span class=nf>fair_dice_roll</span><span class=p>()</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=kt>i32</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-16-2><span class=w>    </span><span class=mi>4</span>
</span><span id=__span-16-3><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>一对大括号声明一个块，它有自己的作用域：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-17-1><span class=c1>// 这首先会打印“in”，然后是“out”</span>
</span><span id=__span-17-2><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-17-3><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;out&quot;</span><span class=p>;</span>
</span><span id=__span-17-4><span class=w>    </span><span class=p>{</span>
</span><span id=__span-17-5><span class=w>        </span><span class=c1>// 这是一个不同的“x”</span>
</span><span id=__span-17-6><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;in&quot;</span><span class=p>;</span>
</span><span id=__span-17-7><span class=w>        </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>x</span><span class=p>);</span>
</span><span id=__span-17-8><span class=w>    </span><span class=p>}</span>
</span><span id=__span-17-9><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>x</span><span class=p>);</span>
</span><span id=__span-17-10><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>“块”也是表达式，意味着它们的计算结果为一个值。</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-18-1><span class=c1>// 这条语句</span>
</span><span id=__span-18-2><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=p>;</span>
</span><span id=__span-18-3>
</span><span id=__span-18-4><span class=c1>// 和这条语句等价</span>
</span><span id=__span-18-5><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=mi>42</span><span class=w> </span><span class=p>};</span>
</span></code></pre></div></td></tr></table></div> <p>在一个块中，可以有多条语句：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-19-1><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-19-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=c1>// 第一个声明</span>
</span><span id=__span-19-3><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span><span class=w> </span><span class=c1>// 第二个声明</span>
</span><span id=__span-19-4><span class=w>    </span><span class=n>y</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=c1>// 这是 *结尾*，即整个块的计算结果</span>
</span><span id=__span-19-5><span class=p>};</span>
</span></code></pre></div></td></tr></table></div> <p>这就是为什么“省略函数末尾的分号”与“返回这个值”相同，即，下面的两个函数是等效的：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-20-1><span class=k>fn</span><span class=w> </span><span class=nf>fair_dice_roll</span><span class=p>()</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=kt>i32</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-2><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>4</span><span class=p>;</span>
</span><span id=__span-20-3><span class=p>}</span>
</span><span id=__span-20-4>
</span><span id=__span-20-5><span class=k>fn</span><span class=w> </span><span class=nf>fair_dice_roll</span><span class=p>()</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=kt>i32</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-20-6><span class=w>    </span><span class=mi>4</span>
</span><span id=__span-20-7><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p><code>if</code> 条件也可以是表达式：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-21-1><span class=k>fn</span><span class=w> </span><span class=nf>fair_dice_roll</span><span class=p>()</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=kt>i32</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-21-2><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=n>feeling_lucky</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-21-3><span class=w>        </span><span class=mi>6</span>
</span><span id=__span-21-4><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-21-5><span class=w>        </span><span class=mi>4</span>
</span><span id=__span-21-6><span class=w>    </span><span class=p>}</span>
</span><span id=__span-21-7><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p><code>match</code> 也是一个表达式：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-22-1><span class=k>fn</span><span class=w> </span><span class=nf>fair_dice_roll</span><span class=p>()</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=kt>i32</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-22-2><span class=w>    </span><span class=k>match</span><span class=w> </span><span class=n>feeling_lucky</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-22-3><span class=w>        </span><span class=kc>true</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=mi>6</span><span class=p>,</span>
</span><span id=__span-22-4><span class=w>        </span><span class=kc>false</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=mi>4</span><span class=p>,</span>
</span><span id=__span-22-5><span class=w>    </span><span class=p>}</span>
</span><span id=__span-22-6><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>“点”<code>.</code>通常用于访问值的字段：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-23-1><span class=kd>let</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>20</span><span class=p>);</span>
</span><span id=__span-23-2><span class=n>a</span><span class=p>.</span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=c1>// this is 10</span>
</span><span id=__span-23-3>
</span><span id=__span-23-4><span class=kd>let</span><span class=w> </span><span class=n>amos</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>get_some_struct</span><span class=p>();</span>
</span><span id=__span-23-5><span class=n>amos</span><span class=p>.</span><span class=n>nickname</span><span class=p>;</span><span class=w> </span><span class=c1>// this is &quot;fasterthanlime&quot;</span>
</span></code></pre></div></td></tr></table></div> <p>或者调用方法：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-24-1><span class=kd>let</span><span class=w> </span><span class=n>nick</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;fasterthanlime&quot;</span><span class=p>;</span>
</span><span id=__span-24-2><span class=n>nick</span><span class=p>.</span><span class=n>len</span><span class=p>();</span><span class=w> </span><span class=c1>// this is 14</span>
</span></code></pre></div></td></tr></table></div> <p>“双冒号”<code>::</code>与此类似，但它的操作对象是命名空间。 在此示例中，<code>std</code>是一个 crate（相当于一个库），<code>cmp</code>是一个模块（相当于一个源文件），<code>min</code>是一个函数： </p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-25-1><span class=kd>let</span><span class=w> </span><span class=n>least</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>cmp</span><span class=p>::</span><span class=n>min</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>8</span><span class=p>);</span><span class=w> </span><span class=c1>// this is 3</span>
</span></code></pre></div></td></tr></table></div> <p><code>use</code>指令可用于将其他命名空间名称引入到当前：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-26-1><span class=k>use</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>cmp</span><span class=p>::</span><span class=n>min</span><span class=p>;</span>
</span><span id=__span-26-2>
</span><span id=__span-26-3><span class=kd>let</span><span class=w> </span><span class=n>least</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>min</span><span class=p>(</span><span class=mi>7</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>);</span><span class=w> </span><span class=c1>// this is 1</span>
</span></code></pre></div></td></tr></table></div> <p>在<code>use</code>指令中，大括号还有另一个含义：它们是一组名称（<code>glob</code>）。如果我们想用<code>use</code>同时导入<code>min</code>和<code>max</code>，那么可以： </p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-27-1><span class=c1>// this works:</span>
</span><span id=__span-27-2><span class=k>use</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>cmp</span><span class=p>::</span><span class=n>min</span><span class=p>;</span>
</span><span id=__span-27-3><span class=k>use</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>cmp</span><span class=p>::</span><span class=n>max</span><span class=p>;</span>
</span><span id=__span-27-4>
</span><span id=__span-27-5><span class=c1>// this also works:</span>
</span><span id=__span-27-6><span class=k>use</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>cmp</span><span class=p>::{</span><span class=n>min</span><span class=p>,</span><span class=w> </span><span class=n>max</span><span class=p>};</span>
</span><span id=__span-27-7>
</span><span id=__span-27-8><span class=c1>// this also works!</span>
</span><span id=__span-27-9><span class=k>use</span><span class=w> </span><span class=n>std</span><span class=p>::{</span><span class=n>cmp</span><span class=p>::</span><span class=n>min</span><span class=p>,</span><span class=w> </span><span class=n>cmp</span><span class=p>::</span><span class=n>max</span><span class=p>};</span>
</span></code></pre></div></td></tr></table></div> <p>通配符 <code>*</code> 允许您导入命名空间下所有名称：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-28-1><span class=c1>// 这不仅将“min”和“max”引入代码中，而且并包括模块中的其他名称</span>
</span><span id=__span-28-2><span class=k>use</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>cmp</span><span class=p>::</span><span class=o>*</span><span class=p>;</span>
</span></code></pre></div></td></tr></table></div> <p>类型也是命名空间，方法可以作为常规函数调用：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-29-1><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;amos&quot;</span><span class=p>.</span><span class=n>len</span><span class=p>();</span><span class=w> </span><span class=c1>// this is 4</span>
</span><span id=__span-29-2><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kt>str</span><span class=p>::</span><span class=n>len</span><span class=p>(</span><span class=s>&quot;amos&quot;</span><span class=p>);</span><span class=w> </span><span class=c1>// this is also 4</span>
</span></code></pre></div></td></tr></table></div> <p><code>str</code>是基本类型(primitive type)，但默认命名空间下也有许多非基本类型。</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-30-1><span class=c1>// `Vec` 是一个常规结构，而不是原始类型</span>
</span><span id=__span-30-2><span class=kd>let</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Vec</span><span class=p>::</span><span class=n>new</span><span class=p>();</span>
</span><span id=__span-30-3>
</span><span id=__span-30-4><span class=c1>// 这是和上述完全等价的代码，但具有访问到“Vec”的*完整*路径</span>
</span><span id=__span-30-5><span class=kd>let</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>vec</span><span class=p>::</span><span class=nb>Vec</span><span class=p>::</span><span class=n>new</span><span class=p>();</span>
</span></code></pre></div></td></tr></table></div> <p>这是因为 Rust 会在每个模块的开头插入它：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-31-1><span class=k>use</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>prelude</span><span class=p>::</span><span class=n>v1</span><span class=p>::</span><span class=o>*</span><span class=p>;</span>
</span></code></pre></div></td></tr></table></div> <p>（这反过来又会导入其他许多符号，如<code>Vec</code>、<code>String</code>、<code>Option</code>和<code>Result</code>）。</p> <p>结构体使用<code>struct</code>关键字声明：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-32-1><span class=k>struct</span><span class=w> </span><span class=nc>Vec2</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-32-2><span class=w>    </span><span class=n>x</span><span class=p>:</span><span class=w> </span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=c1>// 64 位浮点，又名“双精度”</span>
</span><span id=__span-32-3><span class=w>    </span><span class=n>y</span><span class=p>:</span><span class=w> </span><span class=kt>f64</span><span class=p>,</span>
</span><span id=__span-32-4><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>它们可以使用“结构体文字”进行初始化：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-33-1><span class=kd>let</span><span class=w> </span><span class=n>v1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Vec2</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span><span class=p>:</span><span class=w> </span><span class=mf>1.0</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>:</span><span class=w> </span><span class=mf>3.0</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-33-2><span class=kd>let</span><span class=w> </span><span class=n>v2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Vec2</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>y</span><span class=p>:</span><span class=w> </span><span class=mf>2.0</span><span class=p>,</span><span class=w> </span><span class=n>x</span><span class=p>:</span><span class=w> </span><span class=mf>4.0</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-33-3><span class=c1>// the order does not matter, only the names do</span>
</span></code></pre></div></td></tr></table></div> <p>有一个快捷方式可以从另一个结构体初始化剩余字段：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-34-1><span class=kd>let</span><span class=w> </span><span class=n>v3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Vec2</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-34-2><span class=w>    </span><span class=n>x</span><span class=p>:</span><span class=w> </span><span class=mf>14.0</span><span class=p>,</span>
</span><span id=__span-34-3><span class=w>    </span><span class=o>..</span><span class=n>v2</span>
</span><span id=__span-34-4><span class=p>};</span>
</span></code></pre></div></td></tr></table></div> <p>这被称为“结构更新语法”（struct update syntax），只能发生在最后一个位置，并且不能后跟逗号。 请注意，“剩余字段”可以是“所有字段”：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-35-1><span class=kd>let</span><span class=w> </span><span class=n>v4</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Vec2</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=o>..</span><span class=n>v3</span><span class=w> </span><span class=p>};</span>
</span></code></pre></div></td></tr></table></div> <p>结构体和元组一样，可以被解构。 下面是一个有效的<code>let</code>模式：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-36-1><span class=kd>let</span><span class=w> </span><span class=p>(</span><span class=n>left</span><span class=p>,</span><span class=w> </span><span class=n>right</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>slice</span><span class=p>.</span><span class=n>split_at</span><span class=p>(</span><span class=n>middle</span><span class=p>);</span>
</span></code></pre></div></td></tr></table></div> <p>也可以这样：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-37-1><span class=kd>let</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Vec2</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span><span class=p>:</span><span class=w> </span><span class=mf>3.0</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=p>:</span><span class=w> </span><span class=mf>6.0</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-37-2><span class=kd>let</span><span class=w> </span><span class=n>Vec2</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>v</span><span class=p>;</span>
</span><span id=__span-37-3><span class=c1>// `x` is now 3.0, `y` is now `6.0`</span>
</span></code></pre></div></td></tr></table></div> <p>还有这个：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-38-1><span class=kd>let</span><span class=w> </span><span class=n>Vec2</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=o>..</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>v</span><span class=p>;</span>
</span><span id=__span-38-2><span class=c1>// this throws away `v.y`</span>
</span></code></pre></div></td></tr></table></div> <p><code>let</code>模式可以用作<code>if</code>中的条件：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-39-1><span class=k>struct</span><span class=w> </span><span class=nc>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-39-2><span class=w>    </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=kt>bool</span><span class=p>,</span>
</span><span id=__span-39-3><span class=w>    </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=kt>i32</span><span class=p>,</span>
</span><span id=__span-39-4><span class=p>}</span>
</span><span id=__span-39-5>
</span><span id=__span-39-6><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-39-7><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>one</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>true</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-39-8><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>two</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>false</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-39-9><span class=w>    </span><span class=n>print_number</span><span class=p>(</span><span class=n>one</span><span class=p>);</span>
</span><span id=__span-39-10><span class=w>    </span><span class=n>print_number</span><span class=p>(</span><span class=n>two</span><span class=p>);</span>
</span><span id=__span-39-11><span class=p>}</span>
</span><span id=__span-39-12>
</span><span id=__span-39-13><span class=k>fn</span><span class=w> </span><span class=nf>print_number</span><span class=p>(</span><span class=n>n</span><span class=p>:</span><span class=w> </span><span class=nc>Number</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-39-14><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=kd>let</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>true</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-39-15><span class=w>        </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Odd number: {}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>);</span>
</span><span id=__span-39-16><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=kd>let</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>false</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-39-17><span class=w>        </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Even number: {}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>);</span>
</span><span id=__span-39-18><span class=w>    </span><span class=p>}</span>
</span><span id=__span-39-19><span class=p>}</span>
</span><span id=__span-39-20>
</span><span id=__span-39-21><span class=c1>// this prints:</span>
</span><span id=__span-39-22><span class=c1>// Odd number: 1</span>
</span><span id=__span-39-23><span class=c1>// Even number: 2</span>
</span></code></pre></div></td></tr></table></div> <p><code>match</code>匹配也是一种模式，就像<code>if let</code>:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-40-1><span class=k>fn</span><span class=w> </span><span class=nf>print_number</span><span class=p>(</span><span class=n>n</span><span class=p>:</span><span class=w> </span><span class=nc>Number</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-40-2><span class=w>    </span><span class=k>match</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-40-3><span class=w>        </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>true</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Odd number: {}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>),</span>
</span><span id=__span-40-4><span class=w>        </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>false</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Even number: {}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>),</span>
</span><span id=__span-40-5><span class=w>    </span><span class=p>}</span>
</span><span id=__span-40-6><span class=p>}</span>
</span><span id=__span-40-7>
</span><span id=__span-40-8><span class=c1>// this prints the same as before</span>
</span></code></pre></div></td></tr></table></div> <p><code>match</code>必须是详尽的，至少需要一个分支来进行匹配</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-41-1><span class=k>fn</span><span class=w> </span><span class=nf>print_number</span><span class=p>(</span><span class=n>n</span><span class=p>:</span><span class=w> </span><span class=nc>Number</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-41-2><span class=w>    </span><span class=k>match</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-41-3><span class=w>        </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=o>..</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;One&quot;</span><span class=p>),</span>
</span><span id=__span-41-4><span class=w>        </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=o>..</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Two&quot;</span><span class=p>),</span>
</span><span id=__span-41-5><span class=w>        </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>value</span><span class=p>,</span><span class=w> </span><span class=o>..</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>),</span>
</span><span id=__span-41-6><span class=w>        </span><span class=c1>// if that last arm didn&#39;t exist, we would get a compile-time error</span>
</span><span id=__span-41-7><span class=w>    </span><span class=p>}</span>
</span><span id=__span-41-8><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>如果这很麻烦，可以用<code>_</code>来匹配所有模式：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-42-1><span class=k>fn</span><span class=w> </span><span class=nf>print_number</span><span class=p>(</span><span class=n>n</span><span class=p>:</span><span class=w> </span><span class=nc>Number</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-42-2><span class=w>    </span><span class=k>match</span><span class=w> </span><span class=n>n</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-42-3><span class=w>        </span><span class=mi>1</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;One&quot;</span><span class=p>),</span>
</span><span id=__span-42-4><span class=w>        </span><span class=mi>2</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;Two&quot;</span><span class=p>),</span>
</span><span id=__span-42-5><span class=w>        </span><span class=n>_</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>.</span><span class=n>value</span><span class=p>),</span>
</span><span id=__span-42-6><span class=w>    </span><span class=p>}</span>
</span><span id=__span-42-7><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>您可以在自己的类型上声明方法：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-43-1><span class=k>struct</span><span class=w> </span><span class=nc>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-43-2><span class=w>    </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=kt>bool</span><span class=p>,</span>
</span><span id=__span-43-3><span class=w>    </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=kt>i32</span><span class=p>,</span>
</span><span id=__span-43-4><span class=p>}</span>
</span><span id=__span-43-5>
</span><span id=__span-43-6><span class=k>impl</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-43-7><span class=w>    </span><span class=k>fn</span><span class=w> </span><span class=nf>is_strictly_positive</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-43-8><span class=w>        </span><span class=bp>self</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-43-9><span class=w>    </span><span class=p>}</span>
</span><span id=__span-43-10><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>并像往常一样使用它们：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-44-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-44-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>minus_two</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-44-3><span class=w>        </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>false</span><span class=p>,</span>
</span><span id=__span-44-4><span class=w>        </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=o>-</span><span class=mi>2</span><span class=p>,</span>
</span><span id=__span-44-5><span class=w>    </span><span class=p>};</span>
</span><span id=__span-44-6><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;positive? {}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>minus_two</span><span class=p>.</span><span class=n>is_strictly_positive</span><span class=p>());</span>
</span><span id=__span-44-7><span class=w>    </span><span class=c1>// this prints &quot;positive? false&quot;</span>
</span><span id=__span-44-8><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>默认情况下，变量绑定是不可变的，这意味着它的变量值不能改变：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-45-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-45-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-45-3><span class=w>        </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>true</span><span class=p>,</span>
</span><span id=__span-45-4><span class=w>        </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>17</span><span class=p>,</span>
</span><span id=__span-45-5><span class=w>    </span><span class=p>};</span>
</span><span id=__span-45-6><span class=w>    </span><span class=n>n</span><span class=p>.</span><span class=n>odd</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kc>false</span><span class=p>;</span><span class=w> </span><span class=c1>// error: cannot assign to `n.odd`,</span>
</span><span id=__span-45-7><span class=w>                   </span><span class=c1>// as `n` is not declared to be mutable</span>
</span><span id=__span-45-8><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>而且它们不能被赋值更改：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-46-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-46-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-46-3><span class=w>        </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>true</span><span class=p>,</span>
</span><span id=__span-46-4><span class=w>        </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>17</span><span class=p>,</span>
</span><span id=__span-46-5><span class=w>    </span><span class=p>};</span>
</span><span id=__span-46-6><span class=w>    </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-46-7><span class=w>        </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>false</span><span class=p>,</span>
</span><span id=__span-46-8><span class=w>        </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>22</span><span class=p>,</span>
</span><span id=__span-46-9><span class=w>    </span><span class=p>};</span><span class=w> </span><span class=c1>// error: cannot assign twice to immutable variable `n`</span>
</span><span id=__span-46-10><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p><code>mut</code>允许变量绑定可更改：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-47-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-47-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-47-3><span class=w>        </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>true</span><span class=p>,</span>
</span><span id=__span-47-4><span class=w>        </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>17</span><span class=p>,</span>
</span><span id=__span-47-5><span class=w>    </span><span class=p>}</span>
</span><span id=__span-47-6><span class=w>    </span><span class=n>n</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>19</span><span class=p>;</span><span class=w> </span><span class=c1>// all good</span>
</span><span id=__span-47-7><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p><code>trait</code>是多种类型拥有的共同点：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-48-1><span class=k>trait</span><span class=w> </span><span class=n>Signed</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-48-2><span class=w>    </span><span class=k>fn</span><span class=w> </span><span class=nf>is_strictly_negative</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=kt>bool</span><span class=p>;</span>
</span><span id=__span-48-3><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>您可以实现：</p> <ul> <li>为任意类型实现你自己定义的trait</li> <li>为你的类型实现任意类型的trait</li> <li>不允许为别人的类型实现别人的trait</li> </ul> <p>这些被称为“孤立规则”(orphan rules)。</p> <p>下面是自定义trait在自定义类型上的实现：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-49-1><span class=k>impl</span><span class=w> </span><span class=n>Signed</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-49-2><span class=w>    </span><span class=k>fn</span><span class=w> </span><span class=nf>is_strictly_negative</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-49-3><span class=w>        </span><span class=bp>self</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-49-4><span class=w>    </span><span class=p>}</span>
</span><span id=__span-49-5><span class=p>}</span>
</span><span id=__span-49-6>
</span><span id=__span-49-7><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-49-8><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>false</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=o>-</span><span class=mi>44</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-49-9><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>.</span><span class=n>is_strictly_negative</span><span class=p>());</span><span class=w> </span><span class=c1>// prints &quot;true&quot;</span>
</span><span id=__span-49-10><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>我们在外部类型（甚至是基本类型）上的实现的自定义trait：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-50-1><span class=k>impl</span><span class=w> </span><span class=n>Signed</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=kt>i32</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-50-2><span class=w>    </span><span class=k>fn</span><span class=w> </span><span class=nf>is_strictly_negative</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=kt>bool</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-50-3><span class=w>        </span><span class=bp>self</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>0</span>
</span><span id=__span-50-4><span class=w>    </span><span class=p>}</span>
</span><span id=__span-50-5><span class=p>}</span>
</span><span id=__span-50-6>
</span><span id=__span-50-7><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-50-8><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>n</span><span class=p>:</span><span class=w> </span><span class=kt>i32</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=mi>44</span><span class=p>;</span>
</span><span id=__span-50-9><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>n</span><span class=p>.</span><span class=n>is_strictly_negative</span><span class=p>());</span><span class=w> </span><span class=c1>// prints &quot;true&quot;</span>
</span><span id=__span-50-10><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>自定义类型的外部trait：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-51-1><span class=c1>// `Neg` 特性用于重载 `-`，</span>
</span><span id=__span-51-2><span class=c1>// 一元减运算符。</span>
</span><span id=__span-51-3><span class=k>impl</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>ops</span><span class=p>::</span><span class=n>Neg</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-51-4><span class=w>    </span><span class=k>type</span><span class=w> </span><span class=nc>Output</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=p>;</span>
</span><span id=__span-51-5>
</span><span id=__span-51-6><span class=w>    </span><span class=k>fn</span><span class=w> </span><span class=nf>neg</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=nc>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-51-7><span class=w>        </span><span class=n>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-51-8><span class=w>            </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=o>-</span><span class=bp>self</span><span class=p>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-51-9><span class=w>            </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>self</span><span class=p>.</span><span class=n>odd</span><span class=p>,</span>
</span><span id=__span-51-10><span class=w>        </span><span class=p>}</span><span class=w>        </span>
</span><span id=__span-51-11><span class=w>    </span><span class=p>}</span>
</span><span id=__span-51-12><span class=p>}</span>
</span><span id=__span-51-13>
</span><span id=__span-51-14><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-51-15><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>true</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>987</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-51-16><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=c1>// this is only possible because we implemented `Neg`</span>
</span><span id=__span-51-17><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>m</span><span class=p>.</span><span class=n>value</span><span class=p>);</span><span class=w> </span><span class=c1>// prints &quot;-987&quot;</span>
</span><span id=__span-51-18><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p><code>impl</code>块总是用来为类型实现方法，因此，在该块内，<code>Self</code>可以指代该类型:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-52-1><span class=k>impl</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>ops</span><span class=p>::</span><span class=n>Neg</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-52-2><span class=w>    </span><span class=k>type</span><span class=w> </span><span class=nc>Output</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=bp>Self</span><span class=p>;</span>
</span><span id=__span-52-3>
</span><span id=__span-52-4><span class=w>    </span><span class=k>fn</span><span class=w> </span><span class=nf>neg</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=nc>Self</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-52-5><span class=w>        </span><span class=bp>Self</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-52-6><span class=w>            </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=o>-</span><span class=bp>self</span><span class=p>.</span><span class=n>value</span><span class=p>,</span>
</span><span id=__span-52-7><span class=w>            </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>self</span><span class=p>.</span><span class=n>odd</span><span class=p>,</span>
</span><span id=__span-52-8><span class=w>        </span><span class=p>}</span><span class=w>        </span>
</span><span id=__span-52-9><span class=w>    </span><span class=p>}</span>
</span><span id=__span-52-10><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>有些trait是“标记”——它们并不是说类型实现了某些方法，而是说可以用类型完成某些事情。 例如<code>i32</code>实现<code>Copy</code> trait(简单地讲，<code>i32</code>是可复制的)，所以下面的代码工作正常:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-53-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-53-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>a</span><span class=p>:</span><span class=w> </span><span class=kt>i32</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>15</span><span class=p>;</span>
</span><span id=__span-53-3><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=p>;</span><span class=w> </span><span class=c1>// `a` is copied</span>
</span><span id=__span-53-4><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a</span><span class=p>;</span><span class=w> </span><span class=c1>// `a` is copied again</span>
</span><span id=__span-53-5><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>这也是正常的：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-54-1><span class=k>fn</span><span class=w> </span><span class=nf>print_i32</span><span class=p>(</span><span class=n>x</span><span class=p>:</span><span class=w> </span><span class=kt>i32</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-54-2><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;x = {}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>x</span><span class=p>);</span>
</span><span id=__span-54-3><span class=p>}</span>
</span><span id=__span-54-4>
</span><span id=__span-54-5><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-54-6><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>a</span><span class=p>:</span><span class=w> </span><span class=kt>i32</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>15</span><span class=p>;</span>
</span><span id=__span-54-7><span class=w>    </span><span class=n>print_i32</span><span class=p>(</span><span class=n>a</span><span class=p>);</span><span class=w> </span><span class=c1>// `a` is copied</span>
</span><span id=__span-54-8><span class=w>    </span><span class=n>print_i32</span><span class=p>(</span><span class=n>a</span><span class=p>);</span><span class=w> </span><span class=c1>// `a` is copied again</span>
</span><span id=__span-54-9><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>但<code>Number</code>类型没有实现<code>Copy</code>，所以下面的代码不起作用：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-55-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-55-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>true</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>51</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-55-3><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=c1>// `n` is moved into `m`</span>
</span><span id=__span-55-4><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>o</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=c1>// error: use of moved value: `n`</span>
</span><span id=__span-55-5><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>这也不行：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-56-1><span class=k>fn</span><span class=w> </span><span class=nf>print_number</span><span class=p>(</span><span class=n>n</span><span class=p>:</span><span class=w> </span><span class=nc>Number</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-56-2><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{} number {}&quot;</span><span class=p>,</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>n</span><span class=p>.</span><span class=n>odd</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>&quot;odd&quot;</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>&quot;even&quot;</span><span class=w> </span><span class=p>},</span><span class=w> </span><span class=n>n</span><span class=p>.</span><span class=n>value</span><span class=p>);</span>
</span><span id=__span-56-3><span class=p>}</span>
</span><span id=__span-56-4>
</span><span id=__span-56-5><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-56-6><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>true</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>51</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-56-7><span class=w>    </span><span class=n>print_number</span><span class=p>(</span><span class=n>n</span><span class=p>);</span><span class=w> </span><span class=c1>// `n` is moved</span>
</span><span id=__span-56-8><span class=w>    </span><span class=n>print_number</span><span class=p>(</span><span class=n>n</span><span class=p>);</span><span class=w> </span><span class=c1>// error: use of moved value: `n`</span>
</span><span id=__span-56-9><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>但如果采用不可变的引用<code>print_number</code>，就是可行的：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-57-1><span class=k>fn</span><span class=w> </span><span class=nf>print_number</span><span class=p>(</span><span class=n>n</span><span class=p>:</span><span class=w> </span><span class=kp>&amp;</span><span class=nc>Number</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-57-2><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{} number {}&quot;</span><span class=p>,</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>n</span><span class=p>.</span><span class=n>odd</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>&quot;odd&quot;</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>&quot;even&quot;</span><span class=w> </span><span class=p>},</span><span class=w> </span><span class=n>n</span><span class=p>.</span><span class=n>value</span><span class=p>);</span>
</span><span id=__span-57-3><span class=p>}</span>
</span><span id=__span-57-4>
</span><span id=__span-57-5><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-57-6><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>true</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>51</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-57-7><span class=w>    </span><span class=n>print_number</span><span class=p>(</span><span class=o>&amp;</span><span class=n>n</span><span class=p>);</span><span class=w> </span><span class=c1>// `n` is borrowed for the time of the call</span>
</span><span id=__span-57-8><span class=w>    </span><span class=n>print_number</span><span class=p>(</span><span class=o>&amp;</span><span class=n>n</span><span class=p>);</span><span class=w> </span><span class=c1>// `n` is borrowed again</span>
</span><span id=__span-57-9><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>如果变量被声明为可变的，则函数参数使用可变引用也可以工作:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-58-1><span class=k>fn</span><span class=w> </span><span class=nf>invert</span><span class=p>(</span><span class=n>n</span><span class=p>:</span><span class=w> </span><span class=kp>&amp;</span><span class=nc>mut</span><span class=w> </span><span class=n>Number</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-58-2><span class=w>    </span><span class=n>n</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=n>n</span><span class=p>.</span><span class=n>value</span><span class=p>;</span>
</span><span id=__span-58-3><span class=p>}</span>
</span><span id=__span-58-4><span class=k>fn</span><span class=w> </span><span class=nf>print_number</span><span class=p>(</span><span class=n>n</span><span class=p>:</span><span class=w> </span><span class=kp>&amp;</span><span class=nc>Number</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-58-5><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{} number {}&quot;</span><span class=p>,</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>n</span><span class=p>.</span><span class=n>odd</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>&quot;odd&quot;</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>&quot;even&quot;</span><span class=w> </span><span class=p>},</span><span class=w> </span><span class=n>n</span><span class=p>.</span><span class=n>value</span><span class=p>);</span>
</span><span id=__span-58-6><span class=p>}</span>
</span><span id=__span-58-7><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-58-8><span class=w>    </span><span class=c1>// this time, `n` is mutable</span>
</span><span id=__span-58-9><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>true</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>51</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-58-10><span class=w>    </span><span class=n>print_number</span><span class=p>(</span><span class=o>&amp;</span><span class=n>n</span><span class=p>);</span>
</span><span id=__span-58-11><span class=w>    </span><span class=n>invert</span><span class=p>(</span><span class=o>&amp;</span><span class=k>mut</span><span class=w> </span><span class=n>n</span><span class=p>);</span><span class=w> </span><span class=c1>// `n is borrowed mutably - everything is explicit</span>
</span><span id=__span-58-12><span class=w>    </span><span class=n>print_number</span><span class=p>(</span><span class=o>&amp;</span><span class=n>n</span><span class=p>);</span>
</span><span id=__span-58-13><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>Trait 方法中的<code>self</code>参数可以使用引用，也可以使用不可变引用</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-59-1><span class=k>impl</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>clone</span><span class=p>::</span><span class=nb>Clone</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-59-2><span class=w>    </span><span class=k>fn</span><span class=w> </span><span class=nf>clone</span><span class=p>(</span><span class=o>&amp;</span><span class=bp>self</span><span class=p>)</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=nc>Self</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-59-3><span class=w>        </span><span class=bp>Self</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=o>..*</span><span class=bp>self</span><span class=w> </span><span class=p>}</span>
</span><span id=__span-59-4><span class=w>    </span><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>当调用trait的方法时，receiver隐式地被借用</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-60-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-60-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>true</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>51</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-60-3><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>.</span><span class=n>clone</span><span class=p>();</span>
</span><span id=__span-60-4><span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>value</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=mi>100</span><span class=p>;</span>
</span><span id=__span-60-5>
</span><span id=__span-60-6><span class=w>    </span><span class=n>print_number</span><span class=p>(</span><span class=o>&amp;</span><span class=n>n</span><span class=p>);</span>
</span><span id=__span-60-7><span class=w>    </span><span class=n>print_number</span><span class=p>(</span><span class=o>&amp;</span><span class=n>m</span><span class=p>);</span>
</span><span id=__span-60-8><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>强调一点，下面的代码是等价的:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-61-1><span class=kd>let</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>.</span><span class=n>clone</span><span class=p>();</span>
</span><span id=__span-61-2>
</span><span id=__span-61-3><span class=kd>let</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>clone</span><span class=p>::</span><span class=nb>Clone</span><span class=p>::</span><span class=n>clone</span><span class=p>(</span><span class=o>&amp;</span><span class=n>n</span><span class=p>);</span>
</span></code></pre></div></td></tr></table></div> <p>像 <code>Copy</code> 这样的 Marker traits 是没有实现原对象trait方法的</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-62-1><span class=c1>// note: `Copy` requires that `Clone` is implemented too</span>
</span><span id=__span-62-2><span class=k>impl</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>clone</span><span class=p>::</span><span class=nb>Clone</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-62-3><span class=w>    </span><span class=k>fn</span><span class=w> </span><span class=nf>clone</span><span class=p>(</span><span class=o>&amp;</span><span class=bp>self</span><span class=p>)</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=nc>Self</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-62-4><span class=w>        </span><span class=bp>Self</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=o>..*</span><span class=bp>self</span><span class=w> </span><span class=p>}</span>
</span><span id=__span-62-5><span class=w>    </span><span class=p>}</span>
</span><span id=__span-62-6><span class=p>}</span>
</span><span id=__span-62-7>
</span><span id=__span-62-8><span class=k>impl</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>marker</span><span class=p>::</span><span class=nb>Copy</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{}</span>
</span></code></pre></div></td></tr></table></div> <p>现在<code>Clone</code>仍然可以使用:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-63-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-63-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>true</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>51</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-63-3><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>.</span><span class=n>clone</span><span class=p>();</span>
</span><span id=__span-63-4><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>o</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>.</span><span class=n>clone</span><span class=p>();</span>
</span><span id=__span-63-5><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>但是<code>Number</code>的值不会被转移了</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-64-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-64-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Number</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=nc>true</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=mi>51</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-64-3><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=c1>// `m` is a copy of `n`</span>
</span><span id=__span-64-4><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>o</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=c1>// same. `n` is neither moved nor borrowed.</span>
</span><span id=__span-64-5><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>一些<code>trait</code>太通用了，我们可以通过derive属性自动实现它们:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-65-1><span class=cp>#[derive(Clone, Copy)]</span>
</span><span id=__span-65-2><span class=k>struct</span><span class=w> </span><span class=nc>Number</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-65-3><span class=w>    </span><span class=n>odd</span><span class=p>:</span><span class=w> </span><span class=kt>bool</span><span class=p>,</span>
</span><span id=__span-65-4><span class=w>    </span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=kt>i32</span><span class=p>,</span>
</span><span id=__span-65-5><span class=p>}</span>
</span><span id=__span-65-6>
</span><span id=__span-65-7><span class=c1>// this expands to `impl Clone for Number` and `impl Copy for Number` blocks.</span>
</span></code></pre></div></td></tr></table></div> <p>函数可以是泛型的:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-66-1><span class=k>fn</span><span class=w> </span><span class=nf>foobar</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=p>(</span><span class=n>arg</span><span class=p>:</span><span class=w> </span><span class=nc>T</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-66-2><span class=w>    </span><span class=c1>// do something with `arg`</span>
</span><span id=__span-66-3><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>它们可以有多个“类型参数”，类型参数用在函数声明和函数体中，用来替代具体的类型:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-67-1><span class=k>fn</span><span class=w> </span><span class=nf>foobar</span><span class=o>&lt;</span><span class=n>L</span><span class=p>,</span><span class=w> </span><span class=n>R</span><span class=o>&gt;</span><span class=p>(</span><span class=n>left</span><span class=p>:</span><span class=w> </span><span class=nc>L</span><span class=p>,</span><span class=w> </span><span class=n>right</span><span class=p>:</span><span class=w> </span><span class=nc>R</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-67-2><span class=w>    </span><span class=c1>// do something with `left` and `right`</span>
</span><span id=__span-67-3><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>类型参数通常有“约束”，所以你可以用它做一些额外的事情。</p> <p>最简单的约束就是trait名称:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-68-1><span class=k>fn</span><span class=w> </span><span class=nf>print</span><span class=o>&lt;</span><span class=n>T</span><span class=p>:</span><span class=w> </span><span class=nc>Display</span><span class=o>&gt;</span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=nc>T</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-68-2><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;value = {}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>);</span>
</span><span id=__span-68-3><span class=p>}</span>
</span><span id=__span-68-4>
</span><span id=__span-68-5><span class=k>fn</span><span class=w> </span><span class=nf>print</span><span class=o>&lt;</span><span class=n>T</span><span class=p>:</span><span class=w> </span><span class=nc>Debug</span><span class=o>&gt;</span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=nc>T</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-68-6><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;value = {:?}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>);</span>
</span><span id=__span-68-7><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>类型参数约束可以有更长的语法：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-69-1><span class=k>fn</span><span class=w> </span><span class=nf>print</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=p>(</span><span class=n>value</span><span class=p>:</span><span class=w> </span><span class=nc>T</span><span class=p>)</span>
</span><span id=__span-69-2><span class=k>where</span>
</span><span id=__span-69-3><span class=w>    </span><span class=n>T</span><span class=p>:</span><span class=w> </span><span class=nc>Display</span><span class=p>,</span>
</span><span id=__span-69-4><span class=p>{</span>
</span><span id=__span-69-5><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;value = {}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>);</span>
</span><span id=__span-69-6><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>约束还可以变得更加复杂，比如要求类型参数要实现多种trait:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-70-1><span class=k>use</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>fmt</span><span class=p>::</span><span class=n>Debug</span><span class=p>;</span>
</span><span id=__span-70-2>
</span><span id=__span-70-3><span class=k>fn</span><span class=w> </span><span class=nf>compare</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=p>(</span><span class=n>left</span><span class=p>:</span><span class=w> </span><span class=nc>T</span><span class=p>,</span><span class=w> </span><span class=n>right</span><span class=p>:</span><span class=w> </span><span class=nc>T</span><span class=p>)</span>
</span><span id=__span-70-4><span class=k>where</span>
</span><span id=__span-70-5><span class=w>    </span><span class=n>T</span><span class=p>:</span><span class=w> </span><span class=nc>Debug</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=nb>PartialEq</span><span class=p>,</span>
</span><span id=__span-70-6><span class=p>{</span>
</span><span id=__span-70-7><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{:?} {} {:?}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>left</span><span class=p>,</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=n>left</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>right</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>&quot;==&quot;</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=s>&quot;!=&quot;</span><span class=w> </span><span class=p>},</span><span class=w> </span><span class=n>right</span><span class=p>);</span>
</span><span id=__span-70-8><span class=p>}</span>
</span><span id=__span-70-9>
</span><span id=__span-70-10><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-70-11><span class=w>    </span><span class=n>compare</span><span class=p>(</span><span class=s>&quot;tea&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;coffee&quot;</span><span class=p>);</span>
</span><span id=__span-70-12><span class=w>    </span><span class=c1>// prints: &quot;tea&quot; != &quot;coffee&quot;</span>
</span><span id=__span-70-13><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>泛型函数可以被当作一个命名空间，包含无穷多个不同具体类型的函数。</p> <p>类似<code>crate</code>、<code>module</code>和<code>type</code>，泛型函数可以使用<code>::</code>导航:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-71-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-71-2><span class=w>    </span><span class=k>use</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>any</span><span class=p>::</span><span class=n>type_name</span><span class=p>;</span>
</span><span id=__span-71-3><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>type_name</span><span class=p>::</span><span class=o>&lt;</span><span class=kt>i32</span><span class=o>&gt;</span><span class=p>());</span><span class=w> </span><span class=c1>// prints &quot;i32&quot;</span>
</span><span id=__span-71-4><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>type_name</span><span class=p>::</span><span class=o>&lt;</span><span class=p>(</span><span class=kt>f64</span><span class=p>,</span><span class=w> </span><span class=kt>char</span><span class=p>)</span><span class=o>&gt;</span><span class=p>());</span><span class=w> </span><span class=c1>// prints &quot;(f64, char)&quot;</span>
</span><span id=__span-71-5><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>这被亲切地称之为<a href=https://turbo.fish/ >turbofish 语法</a>，因为<code>::&lt;&gt;</code>看起来像条鱼。:)</p> <p>结构体也可以是泛型的:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-72-1><span class=k>struct</span><span class=w> </span><span class=nc>Pair</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-72-2><span class=w>    </span><span class=n>a</span><span class=p>:</span><span class=w> </span><span class=nc>T</span><span class=p>,</span>
</span><span id=__span-72-3><span class=w>    </span><span class=n>b</span><span class=p>:</span><span class=w> </span><span class=nc>T</span><span class=p>,</span>
</span><span id=__span-72-4><span class=p>}</span>
</span><span id=__span-72-5>
</span><span id=__span-72-6><span class=k>fn</span><span class=w> </span><span class=nf>print_type_name</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=p>(</span><span class=n>_val</span><span class=p>:</span><span class=w> </span><span class=kp>&amp;</span><span class=nc>T</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-72-7><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>any</span><span class=p>::</span><span class=n>type_name</span><span class=p>::</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=p>());</span>
</span><span id=__span-72-8><span class=p>}</span>
</span><span id=__span-72-9>
</span><span id=__span-72-10><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-72-11><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>p1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Pair</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>a</span><span class=p>:</span><span class=w> </span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>:</span><span class=w> </span><span class=mi>9</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-72-12><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>p2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Pair</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>a</span><span class=p>:</span><span class=w> </span><span class=nc>true</span><span class=p>,</span><span class=w> </span><span class=n>b</span><span class=p>:</span><span class=w> </span><span class=nc>false</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-72-13><span class=w>    </span><span class=n>print_type_name</span><span class=p>(</span><span class=o>&amp;</span><span class=n>p1</span><span class=p>);</span><span class=w> </span><span class=c1>// prints &quot;Pair&lt;i32&gt;&quot;</span>
</span><span id=__span-72-14><span class=w>    </span><span class=n>print_type_name</span><span class=p>(</span><span class=o>&amp;</span><span class=n>p2</span><span class=p>);</span><span class=w> </span><span class=c1>// prints &quot;Pair&lt;bool&gt;&quot;</span>
</span><span id=__span-72-15><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>标准库中的类型<code>Vec</code>(即分配在堆上的数组)就是泛型实现的:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-73-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-73-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>v1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Vec</span><span class=p>::</span><span class=n>new</span><span class=p>();</span>
</span><span id=__span-73-3><span class=w>    </span><span class=n>v1</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-73-4><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>v2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Vec</span><span class=p>::</span><span class=n>new</span><span class=p>();</span>
</span><span id=__span-73-5><span class=w>    </span><span class=n>v2</span><span class=p>.</span><span class=n>push</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
</span><span id=__span-73-6><span class=w>    </span><span class=n>print_type_name</span><span class=p>(</span><span class=o>&amp;</span><span class=n>v1</span><span class=p>);</span><span class=w> </span><span class=c1>// prints &quot;Vec&lt;i32&gt;&quot;</span>
</span><span id=__span-73-7><span class=w>    </span><span class=n>print_type_name</span><span class=p>(</span><span class=o>&amp;</span><span class=n>v2</span><span class=p>);</span><span class=w> </span><span class=c1>// prints &quot;Vec&lt;bool&gt;&quot;</span>
</span><span id=__span-73-8><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>谈到Vec，有个宏(macro)可以通过字面方式声明Vec变量:</p> <blockquote> <p>Tip：Rust中可以使用<code>!</code>定义一个宏，例如<code>println!</code>这样的宏；也可以使用上文中<code>#[derive]</code>这样的方式进行自定义</p> </blockquote> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-74-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-74-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>v1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=fm>vec!</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>];</span>
</span><span id=__span-74-3><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>v2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=fm>vec!</span><span class=p>[</span><span class=kc>true</span><span class=p>,</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w> </span><span class=kc>true</span><span class=p>];</span>
</span><span id=__span-74-4><span class=w>    </span><span class=n>print_type_name</span><span class=p>(</span><span class=o>&amp;</span><span class=n>v1</span><span class=p>);</span><span class=w> </span><span class=c1>// prints &quot;Vec&lt;i32&gt;&quot;</span>
</span><span id=__span-74-5><span class=w>    </span><span class=n>print_type_name</span><span class=p>(</span><span class=o>&amp;</span><span class=n>v2</span><span class=p>);</span><span class=w> </span><span class=c1>// prints &quot;Vec&lt;bool&gt;&quot;</span>
</span><span id=__span-74-6><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>类似<code>name!()</code>、<code>name![]</code>、<code>name!{}</code>都是调用宏的方式，宏会被展开成正常的代码。</p> <p>事实上，<code>println</code>就是一个宏:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-75-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-75-2><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{}&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Hello there!&quot;</span><span class=p>);</span>
</span><span id=__span-75-3><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>其展开代码和下面的代码功能一样:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-76-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-76-2><span class=w>    </span><span class=k>use</span><span class=w> </span><span class=n>std</span><span class=p>::</span><span class=n>io</span><span class=p>::{</span><span class=bp>self</span><span class=p>,</span><span class=w> </span><span class=n>Write</span><span class=p>};</span>
</span><span id=__span-76-3><span class=w>    </span><span class=n>io</span><span class=p>::</span><span class=n>stdout</span><span class=p>().</span><span class=n>lock</span><span class=p>().</span><span class=n>write_all</span><span class=p>(</span><span class=s>b&quot;Hello there!</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>).</span><span class=n>unwrap</span><span class=p>();</span>
</span><span id=__span-76-4><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p><code>panic</code>也是一个宏，用来直接停止代码执行并抛出错误信息，同时附带文件名和代码行号（需启用该功能）</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-77-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-77-2><span class=w>    </span><span class=fm>panic!</span><span class=p>(</span><span class=s>&quot;This panics&quot;</span><span class=p>);</span>
</span><span id=__span-77-3><span class=p>}</span>
</span><span id=__span-77-4><span class=c1>// output: thread &#39;main&#39; panicked at &#39;This panics&#39;, src/main.rs:3:5</span>
</span></code></pre></div></td></tr></table></div> <p>有些方法也会出现<code>panic</code>。例如，<code>Option</code>类型可以包含某些内容，也可以不包含任何内容。如果对它调用<code>.unwrap()</code>，并且它不包含任何内容，则会执行<code>panic</code>宏：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-78-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-78-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>o1</span><span class=p>:</span><span class=w> </span><span class=nb>Option</span><span class=o>&lt;</span><span class=kt>i32</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=mi>128</span><span class=p>);</span>
</span><span id=__span-78-3><span class=w>    </span><span class=n>o1</span><span class=p>.</span><span class=n>unwrap</span><span class=p>();</span><span class=w> </span><span class=c1>// this is fine</span>
</span><span id=__span-78-4>
</span><span id=__span-78-5><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>o2</span><span class=p>:</span><span class=w> </span><span class=nb>Option</span><span class=o>&lt;</span><span class=kt>i32</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>None</span><span class=p>;</span>
</span><span id=__span-78-6><span class=w>    </span><span class=n>o2</span><span class=p>.</span><span class=n>unwrap</span><span class=p>();</span><span class=w> </span><span class=c1>// this panics!</span>
</span><span id=__span-78-7><span class=p>}</span>
</span><span id=__span-78-8>
</span><span id=__span-78-9><span class=c1>// output: thread &#39;main&#39; panicked at &#39;called `Option::unwrap()` on a `None` value&#39;, src/libcore/option.rs:378:21</span>
</span></code></pre></div></td></tr></table></div> <blockquote> <p>Tip：Panic 是 Rust 中的一个错误处理机制，当程序遇到无法处理的错误时，它会立即终止当前线程的执行，并开始回溯(unwinding)过程。一般如下情况会出现 Panic:</p> <ol> <li>显式调用<code>panic!</code>宏。</li> <li>某些运行时检查失败，例如数组越界。 <sup id=fnref2:3><a class=footnote-ref href=#fn:3>3</a></sup></li> </ol> </blockquote> <p><code>Option</code>并不是一个结构体，而是一个枚举类型(enum)，它包含两个值:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-79-1><span class=k>enum</span><span class=w> </span><span class=nb>Option</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-79-2><span class=w>    </span><span class=nb>None</span><span class=p>,</span>
</span><span id=__span-79-3><span class=w>    </span><span class=nb>Some</span><span class=p>(</span><span class=n>T</span><span class=p>),</span>
</span><span id=__span-79-4><span class=p>}</span>
</span><span id=__span-79-5>
</span><span id=__span-79-6><span class=k>impl</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=nb>Option</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-79-7><span class=w>    </span><span class=k>fn</span><span class=w> </span><span class=nf>unwrap</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span><span class=w> </span><span class=p>-&gt;</span><span class=w> </span><span class=nc>T</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-79-8><span class=w>        </span><span class=c1>// enums variants can be used in patterns:</span>
</span><span id=__span-79-9><span class=w>        </span><span class=k>match</span><span class=w> </span><span class=bp>self</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-79-10><span class=w>            </span><span class=bp>Self</span><span class=p>::</span><span class=nb>Some</span><span class=p>(</span><span class=n>t</span><span class=p>)</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=n>t</span><span class=p>,</span>
</span><span id=__span-79-11><span class=w>            </span><span class=bp>Self</span><span class=p>::</span><span class=nb>None</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=fm>panic!</span><span class=p>(</span><span class=s>&quot;.unwrap() called on a None option&quot;</span><span class=p>),</span>
</span><span id=__span-79-12><span class=w>        </span><span class=p>}</span>
</span><span id=__span-79-13><span class=w>    </span><span class=p>}</span>
</span><span id=__span-79-14><span class=p>}</span>
</span><span id=__span-79-15>
</span><span id=__span-79-16><span class=k>use</span><span class=w> </span><span class=bp>self</span><span class=p>::</span><span class=nb>Option</span><span class=p>::{</span><span class=nb>None</span><span class=p>,</span><span class=w> </span><span class=nb>Some</span><span class=p>};</span>
</span><span id=__span-79-17>
</span><span id=__span-79-18><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-79-19><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>o1</span><span class=p>:</span><span class=w> </span><span class=nb>Option</span><span class=o>&lt;</span><span class=kt>i32</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>Some</span><span class=p>(</span><span class=mi>128</span><span class=p>);</span>
</span><span id=__span-79-20><span class=w>    </span><span class=n>o1</span><span class=p>.</span><span class=n>unwrap</span><span class=p>();</span><span class=w> </span><span class=c1>// this is fine</span>
</span><span id=__span-79-21>
</span><span id=__span-79-22><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>o2</span><span class=p>:</span><span class=w> </span><span class=nb>Option</span><span class=o>&lt;</span><span class=kt>i32</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>None</span><span class=p>;</span>
</span><span id=__span-79-23><span class=w>    </span><span class=n>o2</span><span class=p>.</span><span class=n>unwrap</span><span class=p>();</span><span class=w> </span><span class=c1>// this panics!</span>
</span><span id=__span-79-24><span class=p>}</span>
</span><span id=__span-79-25>
</span><span id=__span-79-26><span class=c1>// output: thread &#39;main&#39; panicked at &#39;.unwrap() called on a None option&#39;, src/main.rs:11:27</span>
</span></code></pre></div></td></tr></table></div> <p><code>Result</code>也是一个枚举类型。它既可以包含某些结果，也可以包含一个error:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-80-1><span class=k>enum</span><span class=w> </span><span class=nb>Result</span><span class=o>&lt;</span><span class=n>T</span><span class=p>,</span><span class=w> </span><span class=n>E</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-80-2><span class=w>    </span><span class=nb>Ok</span><span class=p>(</span><span class=n>T</span><span class=p>),</span>
</span><span id=__span-80-3><span class=w>    </span><span class=nb>Err</span><span class=p>(</span><span class=n>E</span><span class=p>),</span>
</span><span id=__span-80-4><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>如果包含error，unwrapped时也会触发<code>panic</code>。</p> <p>变量绑定存在“生命周期”:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-81-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-81-2><span class=w>    </span><span class=c1>// `x` doesn&#39;t exist yet</span>
</span><span id=__span-81-3><span class=w>    </span><span class=p>{</span>
</span><span id=__span-81-4><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=p>;</span><span class=w> </span><span class=c1>// `x` starts existing</span>
</span><span id=__span-81-5><span class=w>        </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;x = {}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>x</span><span class=p>);</span>
</span><span id=__span-81-6><span class=w>        </span><span class=c1>// `x` stops existing</span>
</span><span id=__span-81-7><span class=w>    </span><span class=p>}</span>
</span><span id=__span-81-8><span class=w>    </span><span class=c1>// `x` no longer exists</span>
</span><span id=__span-81-9><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>类似地，引用同样存在生命周期:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-82-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-82-2><span class=w>    </span><span class=c1>// `x` doesn&#39;t exist yet</span>
</span><span id=__span-82-3><span class=w>    </span><span class=p>{</span>
</span><span id=__span-82-4><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=p>;</span><span class=w> </span><span class=c1>// `x` starts existing</span>
</span><span id=__span-82-5><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>x_ref</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&amp;</span><span class=n>x</span><span class=p>;</span><span class=w> </span><span class=c1>// `x_ref` starts existing - it borrows `x`</span>
</span><span id=__span-82-6><span class=w>        </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;x_ref = {}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>x_ref</span><span class=p>);</span>
</span><span id=__span-82-7><span class=w>        </span><span class=c1>// `x_ref` stops existing</span>
</span><span id=__span-82-8><span class=w>        </span><span class=c1>// `x` stops existing</span>
</span><span id=__span-82-9><span class=w>    </span><span class=p>}</span>
</span><span id=__span-82-10><span class=w>    </span><span class=c1>// `x` no longer exists</span>
</span><span id=__span-82-11><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>引用的生命周期无法超过它借用的变量的生命周期:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-83-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-83-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>x_ref</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-83-3><span class=w>        </span><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=p>;</span>
</span><span id=__span-83-4><span class=w>        </span><span class=o>&amp;</span><span class=n>x</span>
</span><span id=__span-83-5><span class=w>    </span><span class=p>};</span>
</span><span id=__span-83-6><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;x_ref = {}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>x_ref</span><span class=p>);</span>
</span><span id=__span-83-7><span class=w>    </span><span class=c1>// error: `x` does not live long enough</span>
</span><span id=__span-83-8><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>一个变量可以不可变地引用多次:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-84-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-84-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=p>;</span>
</span><span id=__span-84-3><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>x_ref1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&amp;</span><span class=n>x</span><span class=p>;</span>
</span><span id=__span-84-4><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>x_ref2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&amp;</span><span class=n>x</span><span class=p>;</span>
</span><span id=__span-84-5><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>x_ref3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&amp;</span><span class=n>x</span><span class=p>;</span>
</span><span id=__span-84-6><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;{} {} {}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>x_ref1</span><span class=p>,</span><span class=w> </span><span class=n>x_ref2</span><span class=p>,</span><span class=w> </span><span class=n>x_ref3</span><span class=p>);</span>
</span><span id=__span-84-7><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>在借用的时候，变量不能被修改:</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-85-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-85-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=p>;</span>
</span><span id=__span-85-3><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>x_ref</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&amp;</span><span class=n>x</span><span class=p>;</span>
</span><span id=__span-85-4><span class=w>    </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>13</span><span class=p>;</span>
</span><span id=__span-85-5><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;x_ref = {}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>x_ref</span><span class=p>);</span>
</span><span id=__span-85-6><span class=w>    </span><span class=c1>// error: cannot assign to `x` because it is borrowed</span>
</span><span id=__span-85-7><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>当不可变地借用时，不能同时可变地的借用:</p> <blockquote> <p>Tip：即不能对一个变量同时创建不可变和可变的引用</p> </blockquote> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-86-1><span class=k>fn</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-86-2><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=k>mut</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=p>;</span>
</span><span id=__span-86-3><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>x_ref1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&amp;</span><span class=n>x</span><span class=p>;</span>
</span><span id=__span-86-4><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>x_ref2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&amp;</span><span class=k>mut</span><span class=w> </span><span class=n>x</span><span class=p>;</span>
</span><span id=__span-86-5><span class=w>    </span><span class=c1>// error: cannot borrow `x` as mutable because it is also borrowed as immutable</span>
</span><span id=__span-86-6><span class=w>    </span><span class=fm>println!</span><span class=p>(</span><span class=s>&quot;x_ref1 = {}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>x_ref1</span><span class=p>);</span>
</span><span id=__span-86-7><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>函数参数中的引用同样存在生命周期：</p> <div class=highlight><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-87-1><span class=k>fn</span><span class=w> </span><span class=nf>print</span><span class=p>(</span><span class=n>x</span><span class=p>:</span><span class=w> </span><span class=kp>&amp;</span><span class=kt>i32</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-87-2><span class=w>    </span><span class=c1>// `x` is borrowed (from the outside) for the</span>
</span><span id=__span-87-3><span class=w>    </span><span class=c1>// entire time this function is called.</span>
</span><span id=__span-87-4><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <div class=footnote> <hr> <ol> <li id=fn:1> <p><a href=https://fasterthanli.me/articles/a-half-hour-to-learn-rust>A half-hour to learn Rust</a>&#160;<a class=footnote-backref href=#fnref:1 title="Jump back to footnote 1 in the text">&#8617;</a></p> </li> <li id=fn:2> <p><a href=https://colobu.com/2020/03/05/A-half-hour-to-learn-Rust/ >Rust半小时教程</a>&#160;<a class=footnote-backref href=#fnref:2 title="Jump back to footnote 2 in the text">&#8617;</a></p> </li> <li id=fn:3> <p><a href=https://juejin.cn/post/7314144983018782761>深入探索 Rust 中的 Panic 机制</a>&#160;<a class=footnote-backref href=#fnref:3 title="Jump back to footnote 3 in the text">&#8617;</a><a class=footnote-backref href=#fnref2:3 title="Jump back to footnote 3 in the text">&#8617;</a></p> </li> <li id=fn:4> <p><a href=https://github.com/mainmatter/100-exercises-to-learn-rust>通过100个练习学习Rust</a>&#160;<a class=footnote-backref href=#fnref:4 title="Jump back to footnote 4 in the text">&#8617;</a></p> </li> </ol> </div> <!-- taken from 
https://github.com/squidfunk/mkdocs-material/blob/master/src/partials/source-file.html --> <hr> <div class=md-source-file> <small> <!-- mkdocs-git-revision-date-localized-plugin --> 最后更新: 2024-07-30 <br> 创建日期: 2024-04-19 <!-- mkdocs-git-revision-date-plugin --> </small> </div> <h2 id=__comments>评论</h2> <!-- Insert generated snippet here --> <!-- page.meta.number is defined --> <script src=https://giscus.app/client.js data-repo=jygzyc/notes data-repo-id=R_kgDOJrOxMQ data-mapping=number data-term=8 data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async>
        </script> <!-- Synchronize Giscus theme with palette --> <script>
        var giscus = document.querySelector("script[src*=giscus]")

        // Set palette on initial load
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
            var theme = palette.color.scheme === "slate"
                ? "transparent_dark"
                : "light"

            // Instruct Giscus to set theme
            giscus.setAttribute("data-theme", theme) 
        }

        // Register event handlers after documented loaded
        document.addEventListener("DOMContentLoaded", function() {
            var ref = document.querySelector("[data-md-component=palette]")
            ref.addEventListener("change", function() {
                var palette = __md_get("__palette")
                if (palette && typeof palette.color === "object") {
                    var theme = palette.color.scheme === "slate"
                        ? "transparent_dark"
                        : "light"

                    // Instruct Giscus to change theme
                    var frame = document.querySelector(".giscus-frame")
                    frame.contentWindow.postMessage(
                        { giscus: { setConfig: { theme } } },
                        "https://giscus.app"
                    )
                }
            })
        })
    </script> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> 回到页面顶部 </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=页脚> <a href=../../python/discussion-25/ class="md-footer__link md-footer__link--prev" aria-label="上一页: Python基础知识点"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> 上一页 </span> <div class=md-ellipsis> Python基础知识点 </div> </div> </a> <a href=../../../program_analysis/static_program_analysis/discussion-23/ class="md-footer__link md-footer__link--next" aria-label="下一页: 静态分析笔记"> <div class=md-footer__title> <span class=md-footer__direction> 下一页 </span> <div class=md-ellipsis> 静态分析笔记 </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> 版权所有 © 2022-2024 Ecool的知识花园 </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.footer", "navigation.top", "navigation.path", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "search.suggest", "search.highlight", "search.share", "navigation.indexes", "navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.prune", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script> <script src=../../../../assets/javascripts/bundle.83f73b43.min.js></script> <script src=../../../../js/extra.js></script> <script src=../../../../js/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>